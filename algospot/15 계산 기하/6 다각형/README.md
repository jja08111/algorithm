# 다각형 
## 면적 구하기 
볼록 다각형의 경우 다각형 내부의 한 점을 이용하여 다각형을 삼각형으로 분리한 뒤 외적을 이용하여 면적을 구할 수 있다.  
하지만 오목 다각형의 경우는 약간 다르다.  

오목 다각형은 외적이 방향에 따라 부호가 바뀐다는 점을 이용한다.  
한 점 q를 잡아서 다각형의 꼭지점들과 연결하여 만들어진 삼각형들의 외적을 구하면 양수인 부분과 음수인 부분이 나온다.  
이를 합하면 다각형의 면적이 된다.  
이때 q를 원점으로 정하면 간단한 공식이 나온다.  
- (1/2)×(p0×p1+p1×p2+ ... +p(n-1)×p0)

위 식을 p=(x,y)로 풀어 정리하여 코드를 구현하면 아래와 같다.  

```c++
//주어진 단순 다각형 p의 넓이를 구한다.
//p는 각 꼭지점의 위치 벡터의 집합으로 주어진다. 
double area(const vector<vector2>& p)
{
    double ret=0;
    for(int i=0;i<p.size();++i)
    {
        int j=(i+1)%p.size();
        ret+=p[i].x*p[j].y-p[j].x*p[i].y;
    }
    return fabs(ret)/2.0;
}
```
## 내부/외부 판별 
다각형 내부의 점을 시작으로 x축과 평행하게 반직선으로 나아가는 선과 다각형이 닿는 부분의 수가 짝수이면 외부, 홀수이면 내부인 점을 이용한다.  
아래와 같은 두 가지의 예외에 주의해서 처리한다.  
1. 다각형의 변과 반직선이 겹치는 경우
2. 꼭지점과 반직선이 닿는 경우 

1번의 경우를 방지하기 위해서 다각형의 변이 반직선을 세로로 가로지를 때만 계산한다.  
2번은 반직선을 엄청나게 작은 값 만큼 위로 올리는 것이다. 코드를 보면 실제로는 올리지 않고 반직선 위에 있을 때만 작동하도록 구현한 부분을 볼 수 있다.  
```c++
//점 q가 다각형 p 안에 포함되어 있을 경우 참, 아닌 경우 거짓을 반환한다.
//q가 다각형의 경게 위에 있는 경우의 반환 값은 정의되어 있지 않다.
bool isInside(vector2 q, const vector<vector2>& p)
{
    int crosses=0;
    for(int i=0;i<p.size();++i)
    {
        int j=(i+1)%p.size();
        //(p[i],p[j])가 반직선을 세로로 가로지르는가?
        if((p[i].y>q.y) != (p[j].y>q.y))
        {
            //직선의 방정식을 이용하여 가로지르는 x좌표를 계산한다.
            double atX=(p[j].x-p[i].x)*(q.y-p[i].y)/(p[j].y-p[i].y)+p[i].x;
            if(q.x<atX)
                ++crosses;
        }
    }
    return crosses%2 > 0;
}
```
